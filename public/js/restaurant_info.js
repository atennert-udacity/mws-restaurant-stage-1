let restaurant;var map;document.addEventListener("DOMContentLoaded",e=>{const t=document.getElementsByTagName("head")[0],n=t.insertBefore;t.insertBefore=function(e,a){e.href&&e.href.indexOf("//fonts.googleapis.com/css?family=Roboto")>-1||n.call(t,e,a)},DBHelper.database.then(()=>{fetchRestaurantFromURL((e,t)=>{fillBreadcrumb(),map&&initMap()})})}),window.initMap=(()=>{if(self.restaurant){try{self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:self.restaurant.latlng,scrollwheel:!1})}catch(e){console.log(e)}DBHelper.mapMarkerForRestaurant(self.restaurant,self.map)}else map=!0}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{const t=document.getElementById("restaurant-name");t.textContent=e.name,t.setAttribute("aria-label",`Restaurant: ${e.name}`),document.getElementById("restaurant-address").textContent=e.address;const n=document.getElementById("restaurant-cuisine");n.textContent=e.cuisine_type,n.setAttribute("aria-label",`Cuisine: ${e.cuisine_type}`),fillRestaurantImages(e),e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantImages=((e=self.restaurant)=>{const t=DBHelper.imageUrlForRestaurant(e),n=document.querySelector("#restaurant__image-container > picture");if(!t.endsWith(".svg")){const e=document.createElement("source");e.srcset=t.replace(".","-320."),e.media="(max-width: 320px)";const a=document.createElement("source");a.srcset=t.replace(".","-420."),a.media="(max-width: 420px)";const r=document.createElement("source");r.srcset=t.replace(".","-500."),r.media="(max-width: 500px)",n.appendChild(e),n.appendChild(a),n.appendChild(r)}const a=document.createElement("img");a.id="restaurant-img",a.classList.add("restaurant-img"),a.alt=e.photo_title,a.src=t.replace(".","-orig."),n.appendChild(a),document.getElementById("restaurant__image-caption").textContent=e.photo_title}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours"),n=document.createDocumentFragment(),a=document.createElement("caption");let r,l,s,o,c;a.textContent="Opening hours",a.className="restaurant-hours__caption",n.appendChild(a);const d=Object.keys(e);for(c of d)r=document.createElement("tr"),(l=document.createElement("td")).textContent=c,r.appendChild(l),s=document.createElement("td"),e[c].split(",").map(e=>((o=document.createElement("time")).textContent=e,o)).forEach(e=>s.appendChild(e)),r.appendChild(s),n.appendChild(r);t.appendChild(n)}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createDocumentFragment(),a=document.createElement("h2");if(a.textContent="Reviews",n.appendChild(a),!e){const e=document.createElement("p");return e.textContent="No reviews yet!",void n.appendChild(e)}const r=document.getElementById("reviews-list");let l;for(l of e)r.appendChild(createReviewHTML(l));n.appendChild(r),t.appendChild(n)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p"),a=document.createElement("time"),r=document.createElement("p"),l=document.createElement("p");return t.className="review",n.textContent=e.name,n.className="review__name",t.appendChild(n),a.textContent=e.date,a.className="review__date",t.appendChild(a),r.textContent=`Rating: ${e.rating}`,r.className="review__rating",t.appendChild(r),l.textContent=e.comments,l.className="review__comment",t.appendChild(l),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.textContent=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});